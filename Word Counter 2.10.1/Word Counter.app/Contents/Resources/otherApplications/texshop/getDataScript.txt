set username to do shell script "whoami" --Get the username for which to save the file on the desktopset target_file_text to ("/Users/" & username & "/Desktop/" & "word_counter_temporary_file_texshop.txt")set target_file to (POSIX file target_file_text)--set detexpath to do shell script ("which detex") -- Get detex path--set target_detex to ("." & quoted form of detexpath & " ")  -- format string so it can be run from shellset theText to ""tell application "TeXShop"	set file_data to (the text of the front document) as stringend tellset append_data to false--write the data to a filetry	set the target_file to the target_file as text      	set the open_target_file to open for access file target_file with write permission	if append_data is false then 		set eof of the open_target_file to 0
	end if	write file_data to the open_target_file starting at eof	close access the open_target_fileon error	try		close access file target_file	end tryend tryset the text_to_return to ""try--set the text_to_return to do shell script (target_detex & target_file_text)set the text_to_return to do shell script ( "./usr/texbin/detex " & target_file_text)on errorset the text_to_return to ""end tryset x to do shell script ("rm " & target_file_text)return text_to_return